<!DOCTYPE html>
<html lang="en">
<head>
<title>Lugar Expresivo - Gigantografía - Publicidad para el Perú</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<!-- Include All CSS --><link rel="stylesheet" type="text/css" href="css/bootstrap.css">
<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="css/owl.carousel.css">
<link rel="stylesheet" type="text/css" href="css/owl.theme.css">
<link rel="stylesheet" type="text/css" href="css/magnific-popup.css">
<link rel="stylesheet" type="text/css" href="css/preset.css">
<link rel="stylesheet" type="text/css" href="css/animate.css">
<link rel="stylesheet" type="text/css" href="css/style.css">
<link rel="stylesheet" type="text/css" href="css/responsive.css">
<!-- End Include All CSS --><!--[if lt IE 9]>
	  <script src="js/html5shiv.js"></script>
	  <script src="js/respond.min.js"></script>
	  <![endif]--><!-- Favicon Icon --><link rel="shortcut icon" href="/favicon.ico">
<!-- Favicon Icon --><script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-auth.js"></script><script src="https://www.gstatic.com/firebasejs/6.2.0/firebase-storage.js"></script>
</head>
<body class="index">
	<!-- ========= preloader ========== -->
	<div class="preloader">
		<img src="images/loader.gif" alt="">
</div>
	<!-- ========= End preloader ========== -->
	<!--Header Start-->
	<section class="headertop"><div class="container">
			<div class="row">
				<div class="col-lg-6 col-sm-3 col-xs-6">
					<div class="logo">
						<a href="index.html"><img src="images/logo.png" alt=""></a>
					</div>
				</div>
				<div class="col-lg-6 col-sm-9 col-xs-6">
					<div class="headMiddInfo">
						<div class="  hidden-xs">
							<div class="singMiddInfo phone">
								<i class="fa fa-phone"></i>
								<h4>TELÉFONO</h4>
								<p>01 388-1476</p>
							</div>
							<div class="singMiddInfo email">
								<i class="fa fa-envelope-o"></i>
								<h4>EMAIL</h4>
								<p>contacto@lugarexpresivo.com</p>
							</div>
						</div>
						<div class="clearfix"></div>
					</div>
				</div>
			</div>
		</div>
	</section><!--Header Middle End--><!--Header Start--><header class="header"><div class="container">
			<div class="row">
				<div class="col-lg-9 col-sm-9">
					<nav class="mainnav"><div class="logoMobile hidden-lg hidden-sm hidden-md">
							<a href="index.html">
						<img alt="" src="images/logo.png"></a>
						</div>
						<div class="mobileMenu">
							<span></span>
							<span></span>
							<span></span>
						</div>
						<ul>
							<li class="has-menu-items active smoth-scroll"><a href="index.html">Inicio</a></li>
							<li><a class="smoth-scroll" href="index.html#about">Nosotros</a></li>
							<li><a class="smoth-scroll" href="index.html#services">Servicios</a></li>
							<li class="last_menu"><a class="smoth-scroll" href="index.html#footer">Contacto</a></li>
						</ul>
					</nav>
				</div>
			</div>
		</div>
	</header><!--Header End--><!--Breadcrumb Start--><section class="breadcrumbSec"><div class="container">
				<div class="row">
					<div class="col-xs-12 text-center">
						<h1 class="breadTitle">Gigantografías</h1>
					</div>
				</div>
			</div>
		</section><!--Breadcrumb End--><section id="project" class="commonSection fillterProject noPaddingBottom"><div class="row" id="parentloadimage"><div class="col-lg-3 col-xs-12 col-sm-6 col-md-3"><div class="singlePortfolio mb-0">
<div class="portfolioImg"><img src="https://firebasestorage.googleapis.com/v0/b/editorweb-666.appspot.com/o/images%2Flugarexpresivo%2Fgigantografia%2FFOTO%20TOTEM.jpg?alt=media&amp;token=a5b504ad-0dd0-4a7a-8820-fc739e0d0b5c"></div>
<div class="portfolioHover">
<a href="https://firebasestorage.googleapis.com/v0/b/editorweb-666.appspot.com/o/images%2Flugarexpresivo%2Fgigantografia%2FFOTO%20TOTEM.jpg?alt=media&amp;token=a5b504ad-0dd0-4a7a-8820-fc739e0d0b5c" class="popUp"><i class="fa fa-search-plus"></i></a><a><i class="fa fa-link"></i></a>
</div>
</div></div>
<div class="col-lg-3 col-xs-12 col-sm-6 col-md-3"><div class="singlePortfolio mb-0">
<div class="portfolioImg"><img src="https://firebasestorage.googleapis.com/v0/b/editorweb-666.appspot.com/o/images%2Flugarexpresivo%2Fgigantografia%2FFOTO%20PLOTEO.jpg?alt=media&amp;token=ff7ab57e-1253-47ad-b654-a3dc919a4975"></div>
<div class="portfolioHover">
<a href="https://firebasestorage.googleapis.com/v0/b/editorweb-666.appspot.com/o/images%2Flugarexpresivo%2Fgigantografia%2FFOTO%20PLOTEO.jpg?alt=media&amp;token=ff7ab57e-1253-47ad-b654-a3dc919a4975" class="popUp"><i class="fa fa-search-plus"></i></a><a><i class="fa fa-link"></i></a>
</div>
</div></div></div>
		</section><!--Footer Start--><footer><div id="footer">
			<div class="container">
				<div class="col-md-12 col-xs-12">
					<div class="inside">
						<div class="contact-info">
							<div class="col-md-4 col-xs-12 m-margin">
								<h4>Teléfono</h4>
								<p><a href="tel:01%20388-1476">01 388-1476</a></p>
							</div>
							<div class="col-md-4 col-xs-12 m-margin">
								<h4>Email</h4>
								<p>contacto@lugarexpresivo.com</p>
							</div>
							<div class="col-md-4 col-xs-12 m-margin">
								<h4>Direcci&Atilde;&sup3;n</h4>
								<p>Esquina Jr. Republicana con Escritores</p>
							</div>
						</div>
						<div class="social col-md-12">
							<a target="_blank" href="https://www.facebook.com/Lugar.Expresivo1"><i class="fa fa-facebook" aria-hidden="true"></i></a>
							<a href="#"><i class="fa fa-youtube" aria-hidden="true"></i></a>
						</div>
					</div>
				</div>
			</div>
		</div>
	</footer><!--Footer End--><!--Copy Right start--><section class="copyright"><div class="container">
			<div class="row">
				<div class="col-sm-12 col-xs-12">
					<p>&Acirc;&copy; 2019 Lugar Expresivo SAC. Derechos reservados.</p>
				</div>
			</div>
		</div>
	</section><a data-target="#imageUpload" class="float">
			<div class="custom-file">
				<br><div class="container">
					<div class="row">
						<div class="col-sm-2 imgUp">
							<label class="btn btn-primary">
								<input type="file" accept="image/*" id="fileButton" multiple></label>
						</div>
					</div>
				</div>
			</div>
		</a>
		<progress value="0" max="100" id="uploader">0%</progress><div class="label-container">
			<div class="label-text">Agregar nueva imagen</div>
			<i class="fa fa-play label-arrow"></i>
		</div>
		<a href="#" id="backToTop"><i class="fa fa-angle-up"></i></a>
		<!-- Include All JS -->
		<script type="text/javascript" src="js/jquery.js"></script><script type="text/javascript" src="js/bootstrap.min.js"></script><script type="text/javascript" src="js/owl.carousel.js"></script><script type="text/javascript" src="js/jquery.magnific-popup.js"></script><script type="text/javascript" src="js/mixer.js"></script><script type="text/javascript" src="js/theme.js"></script><script>
		var loader = document.getElementById('parentloadimage');

		const config = {
			apiKey: "AIzaSyAQI8h3zHTDhHPxR2wjCPraOJ8yq74nkvo",
			authDomain: "editorweb-666.firebaseapp.com",
			databaseURL: "https://editorweb-666.firebaseio.com",
			projectId: "editorweb-666",
			storageBucket: "editorweb-666.appspot.com",
			messagingSenderId: "781262855367",
			appId: "1:781262855367:web:0f5f3e670f77e2ef9732e2"
		};

		function newFunction(i, uploadTask, filename, random, iteration, fileLength) {
			return new Promise(function(resolve, reject) {
				uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED,
					function(snapshot) {
						var progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
						uploader.value = progress;
						switch (snapshot.state) {
							case firebase.storage.TaskState.PAUSED:
								console.log('se ha pausado');
								break;
							case firebase.storage.TaskState.RUNNING:
								console.log('esta corriendo');
								break;
						}
					},
					function(error) {
						reject(error)
						switch (error.code) {
							case 'storage/unauthorized':
								break;
							case 'storage/canceled':
								break;
							case 'storage/unknown':
								break;
						}
					},

					function() {
						uploadTask.snapshot.ref.getDownloadURL().then(function(downloadURL) {
							console.log('Archivo en', downloadURL);

							//~ const downloadURL = uploadTask.snapshot.downloadURL;

							var envoltorio = document.createElement("div");
							envoltorio.setAttribute("class", "col-lg-3 col-xs-12 col-sm-6 col-md-3");

							const unionVisible = document.createElement("div")
							unionVisible.setAttribute("class", "singlePortfolio mb-0")
							envoltorio.appendChild(unionVisible)

							var imagenSolapa = document.createElement("div");
							imagenSolapa.setAttribute("class", "portfolioImg");
							unionVisible.appendChild(imagenSolapa)

							var imagen = document.createElement("img");
							imagen.src = downloadURL
							imagenSolapa.appendChild(imagen)

							const solapa = document.createElement("div")
							solapa.setAttribute("class", "portfolioHover")
							unionVisible.appendChild(solapa)

							const observador = document.createElement("a")
							observador.href = downloadURL
							observador.setAttribute("class", "popUp")
							solapa.appendChild(observador)

							const iconoObservador = document.createElement("i")
							iconoObservador.setAttribute("class", "fa fa-search-plus")
							observador.appendChild(iconoObservador)

							const borrador = document.createElement("a")
							solapa.appendChild(borrador)

							const iconoBorrador = document.createElement("i")
							iconoBorrador.setAttribute("class", "fa fa-link")
							borrador.appendChild(iconoBorrador)

							borrador.onclick = function() {
								var storageRef = firebase.storage().ref("images/" + filename);
								storageRef.delete().then(function() {
									console.log('el this: ' + this)
									var element = document.getElementById("element-" + random);
									element.remove()

								}).catch(function(error) {
									console.log(error)
								});
							}
							loader.appendChild(envoltorio);
							resolve(envoltorio)
						})
					})
			});
		}

		defaultProject = firebase.initializeApp(config);
		var fbBucketName = 'images';
		var uploader = document.getElementById('uploader');
		var fileButton = document.getElementById('fileButton');
		fileButton.addEventListener('change', async function(e) {
			var file = e.target.files;
			var count = [];
			for (i = 0; i < file.length; i++) {
				var storageRef = firebase.storage().ref(`${fbBucketName}/lugarexpresivo/gigantografia/${file[i].name}`);
				var uploadTask = storageRef.put(file[i]);
				var data = await newFunction(i, uploadTask, file[i].name, Math.floor((Math.random() * 10000) + 1), i, file.length)
				count.push(data);
				if(count.length == file.length) {
					firebase.auth().currentUser.getIdToken().then(function(idToken) {
					//~ var url = window.location.href
						var id = loader.id;
						var contenido = loader.innerHTML;
						contenido = contenido.replace(/"/g, "'")
						//~ console.log("Dimensi&Atilde;&sup3;n de contenido:", contenido.length)
						var json = {
							"pagina": "gigantografia.html",
							"cambios": [{
								"id": id,
								"contenido": contenido
							}],
							"token": idToken
						}
						const json_upload = JSON.stringify(json);
						var xmlhttp = new XMLHttpRequest();
						xmlhttp.open("POST", "https://www.redhardtec.com/editor.cgi");
						xmlhttp.setRequestHeader("Content-Type", "application/json");
						xmlhttp.send(json_upload);
						console.log('-----------------------------  ----------------------')
						console.log(json_upload)
					}).catch(function(error) {
						if(error) throw error
					})
				}
			}
		});
		</script>
</body>
</html>
